; chip8255_test.asm
chip8255_pc  	equ		28AH
chip8255_pa  	equ 	288H
chip8255_control 	equ		28BH
DSEG SEGMENT
DSEG ENDS
EXTRA1 SEGMENT

EXTRA1 ENDS
CSEG SEGMENT
ASSUME CS:CSEG,DS:DSEG,ES:EXTRA1
START:
MOV AX,DSEG
MOV DS,AX
MOV AX,EXTRA1
MOV ES,AX
				;start coding...
MOV AL,00001001B
MOV DX, chip8255_control
OUT DX,AL
MOV SI,0H
SEND:
CMP SI,1H
JE WAITKEY

CALL DELAY
MOV DX, chip8255_pc
IN AL,DX
MOV DX, chip8255_pa
OUT DX,AL
MOV DL,"*"
CALL SHOW
WAITKEY:
MOV AL,0
MOV DL,0FFH
MOV AH,06H
INT 21H
CMP AL,0
JZ SEND

CMP AL,20H
JNZ EXIT

CMP SI,0H
JZ SETSI 
JMP CLSI
SETSI:
MOV SI,1H
JMP SEND
CLSI:
MOV SI,0H
JMP SEND


EXIT:
MOV AH,4CH
INT 21H

SHOW PROC NEAR
PUSH AX
MOV AH,02H
INT 21H
POP AX
RET
SHOW ENDP

DELAY PROC NEAR
MOV BX,0fffH
LL:
MOV CX,0H
LOOP1:
LOOP LOOP1
DEC BX
JNZ LL
RET
DELAY ENDP
CSEG ENDS
END START
;end chip8255_test.asm
